{% extends "admin/base.html" %}
{% load i18n static %}

{% block title %}{{ title }} | {% trans 'サイト管理' %}{% endblock %}

{% block branding %}
<h1 id="site-name">
    <a href="{% url 'admin:index' %}">
        <svg class="brand-icon" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="display:inline-block;vertical-align:middle;margin-right:6px;">
            <rect x="3" y="3" width="7" height="7"/><rect x="14" y="3" width="7" height="7"/><rect x="14" y="14" width="7" height="7"/><rect x="3" y="14" width="7" height="7"/>
        </svg>
        {{ site_settings.site_name|default:"サイト" }} {% trans '管理ページ' %}
    </a>
</h1>
{% endblock %}

{% block usertools %}
{{ block.super }}
<form action="{% url 'set_language' %}" method="post" style="display:inline;margin-left:10px;">
    {% csrf_token %}
    <input type="hidden" name="next" value="{{ request.path }}">
    <select name="language" onchange="this.form.submit()" class="tw-lang-select">
        {% for lang_code, lang_name in available_languages %}
        <option value="{{ lang_code }}" {% if lang_code == current_language %}selected{% endif %}>{{ lang_name }}</option>
        {% endfor %}
    </select>
</form>
{% endblock %}

{% block extrahead %}
{{ block.super }}
<script src="{% static 'js/admin_chat_widget.js' %}" defer></script>
{% endblock %}

{% block extrastyle %}
{{ block.super }}
<!-- Tailwind CSS CDN -->
<script src="https://cdn.tailwindcss.com"></script>
<script>
tailwind.config = {
    theme: {
        extend: {
            colors: {
                brand: {
                    primary: '#465fff',
                    50: '#eef2ff',
                    100: '#e0e7ff',
                    500: '#465fff',
                    600: '#3b4fdb',
                    700: '#3040b7',
                },
                success: '#12b76a',
                error: '#f04438',
                warning: '#f79009',
            }
        }
    }
}
</script>
<link rel="stylesheet" href="{% static 'css/admin_tailwind.css' %}">
<style>
    /* CSS Custom Properties for theming */
    :root {
        --brand-primary: #465fff;
        --brand-primary-hover: #3b4fdb;
        --success: #12b76a;
        --error: #f04438;
        --warning: #f79009;
        --gray-50: #f9fafb;
        --gray-100: #f3f4f6;
        --gray-200: #e5e7eb;
        --gray-300: #d1d5db;
        --gray-400: #9ca3af;
        --gray-500: #6b7280;
        --gray-600: #4b5563;
        --gray-700: #374151;
        --gray-800: #1f2937;
        --gray-900: #111827;
        --gray-950: #030712;
    }

    /* AdminTheme compatibility */
    {% if admin_theme %}
    :root {
        --admin-primary-color: {{ admin_theme.primary_color|default:"#465fff" }};
        --admin-secondary-color: {{ admin_theme.secondary_color|default:"#f3f4f6" }};
        --brand-primary: {{ admin_theme.primary_color|default:"#465fff" }};
    }
    {% endif %}

    /* Header modernization */
    #header {
        display: flex !important;
        align-items: center;
        justify-content: space-between;
        flex-wrap: wrap;
        background: var(--brand-primary) !important;
        padding: 12px 24px !important;
        box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        {% if admin_theme and admin_theme.header_image %}
        background-image: url('{{ admin_theme.header_image.url }}') !important;
        background-size: cover !important;
        background-position: center !important;
        {% endif %}
    }
    #site-name { flex-shrink: 0; }
    #site-name a {
        font-size: 18px !important;
        font-weight: 600 !important;
        letter-spacing: -0.025em;
    }
    #user-tools {
        margin-left: auto;
        text-align: right;
        font-size: 13px;
    }
    #header a:link, #header a:visited { color: #fff; }

    /* Breadcrumbs */
    div.breadcrumbs {
        background: var(--gray-50) !important;
        color: var(--gray-600) !important;
        padding: 10px 24px !important;
        font-size: 13px;
        border-bottom: 1px solid var(--gray-200);
    }
    div.breadcrumbs a {
        color: var(--brand-primary) !important;
    }

    /* Module headers */
    .module h2, .module caption, .inline-group h2 {
        background: var(--brand-primary) !important;
        border-radius: 8px 8px 0 0;
        padding: 10px 16px !important;
        font-size: 14px !important;
        font-weight: 600;
    }

    /* Links */
    a:link, a:visited {
        color: var(--brand-primary);
    }

    /* Buttons */
    input[type="submit"], .submit-row input, button.default {
        background: var(--brand-primary) !important;
        border-color: var(--brand-primary) !important;
        border-radius: 8px !important;
        padding: 8px 20px !important;
        font-weight: 500 !important;
        transition: opacity 0.15s;
    }
    input[type="submit"]:hover, .submit-row input:hover, button.default:hover {
        opacity: 0.9;
    }

    /* Language selector */
    .tw-lang-select {
        padding: 4px 8px;
        border-radius: 6px;
        border: 1px solid rgba(255,255,255,0.3);
        font-size: 12px;
        background: rgba(255,255,255,0.15);
        color: #fff;
        cursor: pointer;
    }
    .tw-lang-select option {
        color: #333;
        background: #fff;
    }

    /* Content area */
    #content {
        padding: 24px !important;
    }

    /* Body background */
    body.dashboard #content, body {
        background: var(--gray-50);
    }
</style>
{% endblock %}
